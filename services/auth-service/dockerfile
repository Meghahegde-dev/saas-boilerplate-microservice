FROM node:20-alpine
WORKDIR /app

# 1. Copy the shared logger folder
# This makes it available at /app/logger
COPY logger ./logger

# 2. Copy the auth-service folder
# This makes it available at /app/auth-service
COPY services/auth-service ./auth-service

# 3. Change to the service directory
WORKDIR /app/auth-service

# 4. Install dependencies specifically for this service
# This correctly resolves "@shared/logger": "file:../logger" 
# because ../logger now exists at /app/logger
RUN yarn install

EXPOSE 5001
CMD ["node", "src/server.js"]
